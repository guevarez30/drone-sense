{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.loadScript = void 0;\nconst shared_1 = require(\"@clerk/shared\");\nconst info_1 = require(\"../info\");\nconst errorThrower_1 = require(\"./errorThrower\");\nconst isDevOrStageUrl_1 = require(\"./isDevOrStageUrl\");\nconst FAILED_TO_LOAD_ERROR = 'Clerk: Failed to load Clerk';\nconst MISSING_BODY_ERROR = 'Clerk: Missing <body> element.';\nconst UNSTABLE_RELEASE_TAGS = ['staging', 'next'];\nconst extractNonStableTag = packageVersion => {\n  var _a;\n  const tag = (_a = packageVersion.match(/-(.*)\\./)) === null || _a === void 0 ? void 0 : _a[1];\n  return tag && UNSTABLE_RELEASE_TAGS.includes(tag) ? tag : undefined;\n};\nconst extractMajorVersion = packageVersion => {\n  return packageVersion.split('.')[0];\n};\nconst forceStagingReleaseForClerkFapi = frontendApi => {\n  return frontendApi.endsWith('.lclstage.dev') || frontendApi.endsWith('.stgstage.dev') || frontendApi.endsWith('.clerkstage.dev') || frontendApi.endsWith('.accountsstage.dev');\n};\nfunction getScriptSrc(_ref) {\n  let {\n    publishableKey,\n    frontendApi,\n    domain,\n    scriptUrl,\n    scriptVariant = '',\n    proxyUrl\n  } = _ref;\n  var _a, _b;\n  if (scriptUrl) {\n    return scriptUrl;\n  }\n  let scriptHost = '';\n  if (!!proxyUrl && (0, shared_1.isValidProxyUrl)(proxyUrl)) {\n    scriptHost = (0, shared_1.proxyUrlToAbsoluteURL)(proxyUrl).replace(/http(s)?:\\/\\//, '');\n  } else if (domain && !(0, isDevOrStageUrl_1.isDevOrStagingUrl)(((_a = (0, shared_1.parsePublishableKey)(publishableKey)) === null || _a === void 0 ? void 0 : _a.frontendApi) || frontendApi || '')) {\n    scriptHost = (0, shared_1.addClerkPrefix)(domain);\n  } else {\n    scriptHost = ((_b = (0, shared_1.parsePublishableKey)(publishableKey)) === null || _b === void 0 ? void 0 : _b.frontendApi) || frontendApi || '';\n  }\n  if (!scriptHost) {\n    errorThrower_1.errorThrower.throwMissingPublishableKeyError();\n  }\n  const variant = scriptVariant ? `${scriptVariant.replace(/\\.+$/, '')}.` : '';\n  const getUrlForTag = target => {\n    return `https://${scriptHost}/npm/@clerk/clerk-js@${target}/dist/clerk.${variant}browser.js`;\n  };\n  const nonStableTag = extractNonStableTag(info_1.LIB_VERSION);\n  if (forceStagingReleaseForClerkFapi(scriptHost)) {\n    return nonStableTag ? getUrlForTag(nonStableTag) : getUrlForTag('staging');\n  }\n  if (nonStableTag) {\n    return getUrlForTag(nonStableTag);\n  }\n  return getUrlForTag(extractMajorVersion(info_1.LIB_VERSION));\n}\nasync function loadScript(params) {\n  return new Promise((resolve, reject) => {\n    const {\n      frontendApi,\n      publishableKey,\n      proxyUrl,\n      domain\n    } = params;\n    if (global.Clerk) {\n      resolve(null);\n    }\n    const script = document.createElement('script');\n    if (!publishableKey && !frontendApi) {\n      errorThrower_1.errorThrower.throwMissingPublishableKeyError();\n    }\n    if (publishableKey) {\n      script.setAttribute('data-clerk-publishable-key', publishableKey);\n    } else if (frontendApi) {\n      script.setAttribute('data-clerk-frontend-api', frontendApi);\n    }\n    if (proxyUrl) {\n      script.setAttribute('data-clerk-proxy-url', proxyUrl);\n    }\n    if (domain) {\n      script.setAttribute('data-clerk-domain', domain);\n    }\n    script.setAttribute('crossorigin', 'anonymous');\n    script.async = true;\n    if (!document.body) {\n      reject(MISSING_BODY_ERROR);\n    }\n    script.addEventListener('load', () => resolve(script));\n    script.addEventListener('error', () => reject(FAILED_TO_LOAD_ERROR));\n    script.src = getScriptSrc(params);\n    document.body.appendChild(script);\n  });\n}\nexports.loadScript = loadScript;","map":{"version":3,"names":["Object","defineProperty","exports","value","loadScript","shared_1","require","info_1","errorThrower_1","isDevOrStageUrl_1","FAILED_TO_LOAD_ERROR","MISSING_BODY_ERROR","UNSTABLE_RELEASE_TAGS","extractNonStableTag","packageVersion","_a","tag","match","includes","undefined","extractMajorVersion","split","forceStagingReleaseForClerkFapi","frontendApi","endsWith","getScriptSrc","_ref","publishableKey","domain","scriptUrl","scriptVariant","proxyUrl","_b","scriptHost","isValidProxyUrl","proxyUrlToAbsoluteURL","replace","isDevOrStagingUrl","parsePublishableKey","addClerkPrefix","errorThrower","throwMissingPublishableKeyError","variant","getUrlForTag","target","nonStableTag","LIB_VERSION","params","Promise","resolve","reject","global","Clerk","script","document","createElement","setAttribute","async","body","addEventListener","src","appendChild"],"sources":["/home/taylorguevarez/code/clerk/app/node_modules/@clerk/clerk-react/dist/utils/scriptLoader.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.loadScript = void 0;\nconst shared_1 = require(\"@clerk/shared\");\nconst info_1 = require(\"../info\");\nconst errorThrower_1 = require(\"./errorThrower\");\nconst isDevOrStageUrl_1 = require(\"./isDevOrStageUrl\");\nconst FAILED_TO_LOAD_ERROR = 'Clerk: Failed to load Clerk';\nconst MISSING_BODY_ERROR = 'Clerk: Missing <body> element.';\nconst UNSTABLE_RELEASE_TAGS = ['staging', 'next'];\nconst extractNonStableTag = (packageVersion) => {\n    var _a;\n    const tag = (_a = packageVersion.match(/-(.*)\\./)) === null || _a === void 0 ? void 0 : _a[1];\n    return tag && UNSTABLE_RELEASE_TAGS.includes(tag) ? tag : undefined;\n};\nconst extractMajorVersion = (packageVersion) => {\n    return packageVersion.split('.')[0];\n};\nconst forceStagingReleaseForClerkFapi = (frontendApi) => {\n    return (frontendApi.endsWith('.lclstage.dev') ||\n        frontendApi.endsWith('.stgstage.dev') ||\n        frontendApi.endsWith('.clerkstage.dev') ||\n        frontendApi.endsWith('.accountsstage.dev'));\n};\nfunction getScriptSrc({ publishableKey, frontendApi, domain, scriptUrl, scriptVariant = '', proxyUrl, }) {\n    var _a, _b;\n    if (scriptUrl) {\n        return scriptUrl;\n    }\n    let scriptHost = '';\n    if (!!proxyUrl && (0, shared_1.isValidProxyUrl)(proxyUrl)) {\n        scriptHost = (0, shared_1.proxyUrlToAbsoluteURL)(proxyUrl).replace(/http(s)?:\\/\\//, '');\n    }\n    else if (domain && !(0, isDevOrStageUrl_1.isDevOrStagingUrl)(((_a = (0, shared_1.parsePublishableKey)(publishableKey)) === null || _a === void 0 ? void 0 : _a.frontendApi) || frontendApi || '')) {\n        scriptHost = (0, shared_1.addClerkPrefix)(domain);\n    }\n    else {\n        scriptHost = ((_b = (0, shared_1.parsePublishableKey)(publishableKey)) === null || _b === void 0 ? void 0 : _b.frontendApi) || frontendApi || '';\n    }\n    if (!scriptHost) {\n        errorThrower_1.errorThrower.throwMissingPublishableKeyError();\n    }\n    const variant = scriptVariant ? `${scriptVariant.replace(/\\.+$/, '')}.` : '';\n    const getUrlForTag = (target) => {\n        return `https://${scriptHost}/npm/@clerk/clerk-js@${target}/dist/clerk.${variant}browser.js`;\n    };\n    const nonStableTag = extractNonStableTag(info_1.LIB_VERSION);\n    if (forceStagingReleaseForClerkFapi(scriptHost)) {\n        return nonStableTag ? getUrlForTag(nonStableTag) : getUrlForTag('staging');\n    }\n    if (nonStableTag) {\n        return getUrlForTag(nonStableTag);\n    }\n    return getUrlForTag(extractMajorVersion(info_1.LIB_VERSION));\n}\nasync function loadScript(params) {\n    return new Promise((resolve, reject) => {\n        const { frontendApi, publishableKey, proxyUrl, domain } = params;\n        if (global.Clerk) {\n            resolve(null);\n        }\n        const script = document.createElement('script');\n        if (!publishableKey && !frontendApi) {\n            errorThrower_1.errorThrower.throwMissingPublishableKeyError();\n        }\n        if (publishableKey) {\n            script.setAttribute('data-clerk-publishable-key', publishableKey);\n        }\n        else if (frontendApi) {\n            script.setAttribute('data-clerk-frontend-api', frontendApi);\n        }\n        if (proxyUrl) {\n            script.setAttribute('data-clerk-proxy-url', proxyUrl);\n        }\n        if (domain) {\n            script.setAttribute('data-clerk-domain', domain);\n        }\n        script.setAttribute('crossorigin', 'anonymous');\n        script.async = true;\n        if (!document.body) {\n            reject(MISSING_BODY_ERROR);\n        }\n        script.addEventListener('load', () => resolve(script));\n        script.addEventListener('error', () => reject(FAILED_TO_LOAD_ERROR));\n        script.src = getScriptSrc(params);\n        document.body.appendChild(script);\n    });\n}\nexports.loadScript = loadScript;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}